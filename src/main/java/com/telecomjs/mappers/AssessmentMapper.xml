<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.telecomjs.mappers.AssessmentMapper">
  <resultMap id="BaseResultMap" type="com.telecomjs.beans.Assessment">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="ASSESSMENT_ID" jdbcType="DECIMAL" property="assessmentId" />
    <result column="ASSESSMENT_EVENT_ID" jdbcType="DECIMAL" property="assessmentEventId" />
    <result column="AREA_NAME" jdbcType="VARCHAR" property="areaName" />
    <result column="DISTRICT_NAME" jdbcType="VARCHAR" property="districtName" />
    <result column="ZONE_NAME" jdbcType="VARCHAR" property="zoneName" />
    <result column="ZONE_ATTR" jdbcType="VARCHAR" property="zoneAttr" />
    <result column="ZONE_CHANNEL_CODE" jdbcType="DECIMAL" property="zoneChannelCode" />
    <result column="CHANNEL_NAME" jdbcType="VARCHAR" property="channelName" />
    <result column="ZONE_ID" jdbcType="DECIMAL" property="zoneId" />
    <result column="BILLING_CYCLE" jdbcType="DECIMAL" property="billingCycle" />
    <result column="SCORE" jdbcType="DECIMAL" property="score" />
    <result column="CRITERION" jdbcType="DECIMAL" property="criterion" />
    <result column="LAST_REWARD" jdbcType="DECIMAL" property="lastReward" />
    <result column="LAST_FORWARD_REWARD" jdbcType="DECIMAL" property="lastForwardReward" />
    <result column="LAST_SETTLEMENT" jdbcType="DECIMAL" property="lastSettlement" />
    <result column="FORWARD_REWARD" jdbcType="DECIMAL" property="forwardReward" />
    <result column="REWARD" jdbcType="DECIMAL" property="reward" />
    <result column="DOUBLE_REWARD" jdbcType="DECIMAL" property="doubleReward" />
    <result column="STATE" jdbcType="VARCHAR" property="state" />
    <result column="CREATE_DATE" jdbcType="TIMESTAMP" property="createDate" />
  </resultMap>

  <resultMap id="BaseResultMapWithDetail" type="com.telecomjs.beans.AssessmentWithDetail" extends="BaseResultMap">
    <!--<association property="staffAssessment" javaType="com.telecomjs.beans.StaffAssessment">-->
    <collection property="staffAssessmentList"  ofType="com.telecomjs.beans.StaffAssessment">
      <id column="D_ID" jdbcType="DECIMAL" property="id" />
      <result column="D_ASSESSMENT_ID" jdbcType="DECIMAL" property="assessmentId" />
      <result column="D_BILLING_CYCLE" jdbcType="DECIMAL" property="billingCycle" />
      <result column="D_CSS_STAFF_ID" jdbcType="DECIMAL" property="cssStaffId" />
      <result column="D_ASSESSMENT_AMOUNT" jdbcType="DECIMAL" property="assessmentAmount" />
      <result column="D_PERSONAL_AMOUNT" jdbcType="DECIMAL" property="personalAmount" />
      <result column="D_ROLE_NAME" jdbcType="VARCHAR" property="roleName" />
      <result column="D_STATE" jdbcType="VARCHAR" property="state" />
      <result column="D_STATE_DATE" jdbcType="TIMESTAMP" property="stateDate" />
      <result column="D_STAFF_NAME" jdbcType="VARCHAR" property="staffName" />
    </collection>
    <!--</association>-->
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    ASSESSMENT_ID, ASSESSMENT_EVENT_ID, AREA_NAME, DISTRICT_NAME, ZONE_NAME, ZONE_ATTR, 
    ZONE_CHANNEL_CODE, CHANNEL_NAME, ZONE_ID, BILLING_CYCLE, SCORE, CRITERION, LAST_REWARD, 
    LAST_FORWARD_REWARD, LAST_SETTLEMENT, FORWARD_REWARD, REWARD, DOUBLE_REWARD, STATE, 
    CREATE_DATE
  </sql>
  <sql id="Base_Column_List_With_Detail" >
    A.ASSESSMENT_ID, A.ASSESSMENT_EVENT_ID, A.AREA_NAME, A.DISTRICT_NAME, A.ZONE_NAME, A.ZONE_ATTR,
    A.ZONE_CHANNEL_CODE, A.CHANNEL_NAME, A.ZONE_ID, A.BILLING_CYCLE, A.SCORE, A.CRITERION, A.LAST_REWARD,
    A.LAST_FORWARD_REWARD, A.LAST_SETTLEMENT, A.FORWARD_REWARD, A.REWARD, A.DOUBLE_REWARD, A.STATE,
    A.CREATE_DATE
      ,D.ID as D_ID, D.ASSESSMENT_ID as D_ASSESSMENT_ID, D.BILLING_CYCLE as D_BILLING_CYCLE
      , D.CSS_STAFF_ID as D_CSS_STAFF_ID, D.ASSESSMENT_AMOUNT as D_ASSESSMENT_AMOUNT
      , D.PERSONAL_AMOUNT as D_PERSONAL_AMOUNT,       D.ROLE_NAME as D_ROLE_NAME
      , D.STATE as D_STATE, D.STATE_DATE as D_STATE_DATE, D.STAFF_NAME as D_STAFF_NAME
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from ASSESSMENT
    where ASSESSMENT_ID = #{assessmentId,jdbcType=DECIMAL}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from ASSESSMENT
    where ASSESSMENT_ID = #{assessmentId,jdbcType=DECIMAL}
  </delete>
  <insert id="insert" parameterType="com.telecomjs.beans.Assessment">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into ASSESSMENT (ASSESSMENT_ID, ASSESSMENT_EVENT_ID, 
      AREA_NAME, DISTRICT_NAME, ZONE_NAME, 
      ZONE_ATTR, ZONE_CHANNEL_CODE, CHANNEL_NAME, 
      ZONE_ID, BILLING_CYCLE, SCORE, 
      CRITERION, LAST_REWARD, LAST_FORWARD_REWARD, 
      LAST_SETTLEMENT, FORWARD_REWARD, REWARD, 
      DOUBLE_REWARD, STATE, CREATE_DATE
      )
    values (#{assessmentId,jdbcType=DECIMAL}, #{assessmentEventId,jdbcType=DECIMAL}, 
      #{areaName,jdbcType=VARCHAR}, #{districtName,jdbcType=VARCHAR}, #{zoneName,jdbcType=VARCHAR}, 
      #{zoneAttr,jdbcType=VARCHAR}, #{zoneChannelCode,jdbcType=DECIMAL}, #{channelName,jdbcType=VARCHAR}, 
      #{zoneId,jdbcType=DECIMAL}, #{billingCycle,jdbcType=DECIMAL}, #{score,jdbcType=DECIMAL}, 
      #{criterion,jdbcType=DECIMAL}, #{lastReward,jdbcType=DECIMAL}, #{lastForwardReward,jdbcType=DECIMAL}, 
      #{lastSettlement,jdbcType=DECIMAL}, #{forwardReward,jdbcType=DECIMAL}, #{reward,jdbcType=DECIMAL}, 
      #{doubleReward,jdbcType=DECIMAL}, #{state,jdbcType=VARCHAR}, #{createDate,jdbcType=TIMESTAMP}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.telecomjs.beans.Assessment">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into ASSESSMENT
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="assessmentId != null">
        ASSESSMENT_ID,
      </if>
      <if test="assessmentEventId != null">
        ASSESSMENT_EVENT_ID,
      </if>
      <if test="areaName != null">
        AREA_NAME,
      </if>
      <if test="districtName != null">
        DISTRICT_NAME,
      </if>
      <if test="zoneName != null">
        ZONE_NAME,
      </if>
      <if test="zoneAttr != null">
        ZONE_ATTR,
      </if>
      <if test="zoneChannelCode != null">
        ZONE_CHANNEL_CODE,
      </if>
      <if test="channelName != null">
        CHANNEL_NAME,
      </if>
      <if test="zoneId != null">
        ZONE_ID,
      </if>
      <if test="billingCycle != null">
        BILLING_CYCLE,
      </if>
      <if test="score != null">
        SCORE,
      </if>
      <if test="criterion != null">
        CRITERION,
      </if>
      <if test="lastReward != null">
        LAST_REWARD,
      </if>
      <if test="lastForwardReward != null">
        LAST_FORWARD_REWARD,
      </if>
      <if test="lastSettlement != null">
        LAST_SETTLEMENT,
      </if>
      <if test="forwardReward != null">
        FORWARD_REWARD,
      </if>
      <if test="reward != null">
        REWARD,
      </if>
      <if test="doubleReward != null">
        DOUBLE_REWARD,
      </if>
      <if test="state != null">
        STATE,
      </if>
      <if test="createDate != null">
        CREATE_DATE,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="assessmentId != null">
        #{assessmentId,jdbcType=DECIMAL},
      </if>
      <if test="assessmentEventId != null">
        #{assessmentEventId,jdbcType=DECIMAL},
      </if>
      <if test="areaName != null">
        #{areaName,jdbcType=VARCHAR},
      </if>
      <if test="districtName != null">
        #{districtName,jdbcType=VARCHAR},
      </if>
      <if test="zoneName != null">
        #{zoneName,jdbcType=VARCHAR},
      </if>
      <if test="zoneAttr != null">
        #{zoneAttr,jdbcType=VARCHAR},
      </if>
      <if test="zoneChannelCode != null">
        #{zoneChannelCode,jdbcType=DECIMAL},
      </if>
      <if test="channelName != null">
        #{channelName,jdbcType=VARCHAR},
      </if>
      <if test="zoneId != null">
        #{zoneId,jdbcType=DECIMAL},
      </if>
      <if test="billingCycle != null">
        #{billingCycle,jdbcType=DECIMAL},
      </if>
      <if test="score != null">
        #{score,jdbcType=DECIMAL},
      </if>
      <if test="criterion != null">
        #{criterion,jdbcType=DECIMAL},
      </if>
      <if test="lastReward != null">
        #{lastReward,jdbcType=DECIMAL},
      </if>
      <if test="lastForwardReward != null">
        #{lastForwardReward,jdbcType=DECIMAL},
      </if>
      <if test="lastSettlement != null">
        #{lastSettlement,jdbcType=DECIMAL},
      </if>
      <if test="forwardReward != null">
        #{forwardReward,jdbcType=DECIMAL},
      </if>
      <if test="reward != null">
        #{reward,jdbcType=DECIMAL},
      </if>
      <if test="doubleReward != null">
        #{doubleReward,jdbcType=DECIMAL},
      </if>
      <if test="state != null">
        #{state,jdbcType=VARCHAR},
      </if>
      <if test="createDate != null">
        #{createDate,jdbcType=TIMESTAMP},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.telecomjs.beans.Assessment">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update ASSESSMENT
    <set>
      <if test="assessmentEventId != null">
        ASSESSMENT_EVENT_ID = #{assessmentEventId,jdbcType=DECIMAL},
      </if>
      <if test="areaName != null">
        AREA_NAME = #{areaName,jdbcType=VARCHAR},
      </if>
      <if test="districtName != null">
        DISTRICT_NAME = #{districtName,jdbcType=VARCHAR},
      </if>
      <if test="zoneName != null">
        ZONE_NAME = #{zoneName,jdbcType=VARCHAR},
      </if>
      <if test="zoneAttr != null">
        ZONE_ATTR = #{zoneAttr,jdbcType=VARCHAR},
      </if>
      <if test="zoneChannelCode != null">
        ZONE_CHANNEL_CODE = #{zoneChannelCode,jdbcType=DECIMAL},
      </if>
      <if test="channelName != null">
        CHANNEL_NAME = #{channelName,jdbcType=VARCHAR},
      </if>
      <if test="zoneId != null">
        ZONE_ID = #{zoneId,jdbcType=DECIMAL},
      </if>
      <if test="billingCycle != null">
        BILLING_CYCLE = #{billingCycle,jdbcType=DECIMAL},
      </if>
      <if test="score != null">
        SCORE = #{score,jdbcType=DECIMAL},
      </if>
      <if test="criterion != null">
        CRITERION = #{criterion,jdbcType=DECIMAL},
      </if>
      <if test="lastReward != null">
        LAST_REWARD = #{lastReward,jdbcType=DECIMAL},
      </if>
      <if test="lastForwardReward != null">
        LAST_FORWARD_REWARD = #{lastForwardReward,jdbcType=DECIMAL},
      </if>
      <if test="lastSettlement != null">
        LAST_SETTLEMENT = #{lastSettlement,jdbcType=DECIMAL},
      </if>
      <if test="forwardReward != null">
        FORWARD_REWARD = #{forwardReward,jdbcType=DECIMAL},
      </if>
      <if test="reward != null">
        REWARD = #{reward,jdbcType=DECIMAL},
      </if>
      <if test="doubleReward != null">
        DOUBLE_REWARD = #{doubleReward,jdbcType=DECIMAL},
      </if>
      <if test="state != null">
        STATE = #{state,jdbcType=VARCHAR},
      </if>
      <if test="createDate != null">
        CREATE_DATE = #{createDate,jdbcType=TIMESTAMP},
      </if>
    </set>
    where ASSESSMENT_ID = #{assessmentId,jdbcType=DECIMAL}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.telecomjs.beans.Assessment">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update ASSESSMENT
    set ASSESSMENT_EVENT_ID = #{assessmentEventId,jdbcType=DECIMAL},
      AREA_NAME = #{areaName,jdbcType=VARCHAR},
      DISTRICT_NAME = #{districtName,jdbcType=VARCHAR},
      ZONE_NAME = #{zoneName,jdbcType=VARCHAR},
      ZONE_ATTR = #{zoneAttr,jdbcType=VARCHAR},
      ZONE_CHANNEL_CODE = #{zoneChannelCode,jdbcType=DECIMAL},
      CHANNEL_NAME = #{channelName,jdbcType=VARCHAR},
      ZONE_ID = #{zoneId,jdbcType=DECIMAL},
      BILLING_CYCLE = #{billingCycle,jdbcType=DECIMAL},
      SCORE = #{score,jdbcType=DECIMAL},
      CRITERION = #{criterion,jdbcType=DECIMAL},
      LAST_REWARD = #{lastReward,jdbcType=DECIMAL},
      LAST_FORWARD_REWARD = #{lastForwardReward,jdbcType=DECIMAL},
      LAST_SETTLEMENT = #{lastSettlement,jdbcType=DECIMAL},
      FORWARD_REWARD = #{forwardReward,jdbcType=DECIMAL},
      REWARD = #{reward,jdbcType=DECIMAL},
      DOUBLE_REWARD = #{doubleReward,jdbcType=DECIMAL},
      STATE = #{state,jdbcType=VARCHAR},
      CREATE_DATE = #{createDate,jdbcType=TIMESTAMP}
    where ASSESSMENT_ID = #{assessmentId,jdbcType=DECIMAL}
  </update>
  <select id="getPrimaryKey" resultType="java.lang.Integer">
    SELECT seq_assessment_id.nextval from dual
  </select>
  <select id="findAssessmentByStaff" resultMap="BaseResultMap">
    SELECT <include refid="Base_Column_List" />
    FROM assessment
    WHERE ZONE_id in (select area_id_tm from APP_YDBP_AREA_ZWSTAFF where assist_Num = #{staffId})
  </select>
  <select id="findAssessmentByZone" resultMap="BaseResultMap">
    SELECT <include refid="Base_Column_List" />
    FROM assessment
    WHERE assessment_id in (select assessment_Id from assessment_subscriber where zone_id = #{zoneId}  )
  </select>
  <select id="existsAssessmentForDistrict" resultType="Integer">
    SELECT count(1) AS CNT
    FROM assessment
    WHERE ZONE_id in (select area_id_tm from APP_YDBP_AREA where area_id_l2 = #{districtId})
    and assessment_id = #{assessmentId}
  </select>
  <select id="findAll" resultMap="BaseResultMap">
    SELECT <include refid="Base_Column_List" />
    FROM assessment
    ORDER by assessment_id
  </select>
  <select id="findAreaAssessments" resultMap="BaseResultMap">
    select BILLING_CYCLE,AREA_NAME ,STATE
      ,trunc(avg(SCORE),2) as SCORE,sum(LAST_REWARD) as LAST_REWARD
      ,sum(LAST_FORWARD_REWARD) as LAST_FORWARD_REWARD
      ,sum(LAST_SETTLEMENT) as LAST_SETTLEMENT
      ,sum(FORWARD_REWARD) as FORWARD_REWARD
      ,sum(REWARD) as REWARD
      ,sum(DOUBLE_REWARD) as DOUBLE_REWARD
      ,max(CREATE_DATE) as CREATE_DATE
    from ASSESSMENT
    GROUP BY BILLING_CYCLE,AREA_NAME,STATE
  </select>

  <select id="findDistrictAssessments" resultMap="BaseResultMap">
    select BILLING_CYCLE,AREA_NAME,DISTRICT_NAME ,STATE
      ,trunc(avg(SCORE),2) as SCORE,sum(LAST_REWARD) as LAST_REWARD
      ,sum(LAST_FORWARD_REWARD) as LAST_FORWARD_REWARD
      ,sum(LAST_SETTLEMENT) as LAST_SETTLEMENT
      ,sum(FORWARD_REWARD) as FORWARD_REWARD
      ,sum(REWARD) as REWARD
      ,sum(DOUBLE_REWARD) as DOUBLE_REWARD
      ,max(CREATE_DATE) as CREATE_DATE
    from ASSESSMENT
    GROUP BY BILLING_CYCLE,AREA_NAME,DISTRICT_NAME,STATE
  </select>

  <select id="findZoneAssessments" resultMap="BaseResultMap">
    select ASSESSMENT_ID,BILLING_CYCLE,AREA_NAME,DISTRICT_NAME,ZONE_NAME,CHANNEL_NAME,ZONE_ID,STATE
          ,trunc(avg(SCORE),2) as SCORE,sum(LAST_REWARD) as LAST_REWARD
          ,sum(LAST_FORWARD_REWARD) as LAST_FORWARD_REWARD
          ,sum(LAST_SETTLEMENT) as LAST_SETTLEMENT
          ,sum(FORWARD_REWARD) as FORWARD_REWARD
          ,sum(REWARD) as REWARD
          ,sum(DOUBLE_REWARD) as DOUBLE_REWARD
          ,max(CREATE_DATE) as CREATE_DATE
    from ASSESSMENT
    GROUP BY ASSESSMENT_ID,BILLING_CYCLE,AREA_NAME,DISTRICT_NAME,ZONE_NAME,CHANNEL_NAME,ZONE_ID,STATE
  </select>
    <select id="existsZoneAssessment" resultType="java.lang.Integer">
      select count(1) as cnt from ASSESSMENT
      where ZONE_id = #{zone}
      and  ASSESSMENT_ID = #{assessmentId}
    </select>
  <select id="existsStaffAssessment" resultType="java.lang.Integer">
    select count(1) as cnt from ASSESSMENT
    where  ASSESSMENT_ID = #{assessmentId}
    and zone_id in (
      select area_id_tm from APP_YDBP_AREA_ZWSTAFF
      where  ASSIST_NUM = #{cssStaffId}
    )
  </select>
  <select id="findStaffAssessment" resultMap="BaseResultMapWithDetail">
    select <include refid="Base_Column_List_With_Detail" />
    from ASSESSMENT a
    LEFT JOIN staff_assessment D on a.assessment_id=d.assessment_id and d.STATE not in ('REP','CLS')
    where  a.BILLING_CYCLE = #{billingCycle}
  </select>
  <select id="findStaffAssessmentByDistrict" resultMap="BaseResultMapWithDetail">
    select <include refid="Base_Column_List_With_Detail" />
    from ASSESSMENT a
    LEFT JOIN staff_assessment D on  a.assessment_id=d.assessment_id and d.STATE not in ('REP','CLS')
    where   a.BILLING_CYCLE = #{billingCycle}
    and a.zone_id in
    (
    select AREA_ID_TM from APP_YDBP_AREA
    where area_id_l2 = #{districtId}
    )
  </select>

  <select id="findStaffAssessmentByArea" resultMap="BaseResultMapWithDetail">
    select <include refid="Base_Column_List_With_Detail" />
    from ASSESSMENT a
    LEFT JOIN staff_assessment D on  a.assessment_id=d.assessment_id and d.STATE not in ('REP','CLS')
    where a.BILLING_CYCLE = #{billingCycle}
    and a.zone_id in
    (
    select AREA_ID_TM from APP_YDBP_AREA
    where area_id = #{areaId}
    )

  </select>
  <select id="findAssessmentForDistrictAndState" resultMap="BaseResultMap">
    select <include refid="Base_Column_List" />
    from ASSESSMENT a
    where a.zone_id in
    (
    select AREA_ID_TM from APP_YDBP_AREA
    where area_id_l2 = #{districtId}
    )
    and state = #{state}
  </select>
  <select id="findAssessmentForDistrictAndCycle" resultMap="BaseResultMap">
    select <include refid="Base_Column_List" />
    from ASSESSMENT a
    where a.zone_id in
    (
    select AREA_ID_TM from APP_YDBP_AREA
    where area_id_l2 = #{districtId}
    )
    AND a.BILLING_CYCLE = #{billingCycle}
    and state  not in ('CLS')
    Order by assessment_id
  </select>

  <select id="findAssessmentForAreaAndCycle" resultMap="BaseResultMap">
    select <include refid="Base_Column_List" />
    from ASSESSMENT a
    where a.zone_id in
    (
    select AREA_ID_TM from APP_YDBP_AREA
    where area_id = #{areaId}
    )
    AND a.BILLING_CYCLE = #{billingCycle}
    and state  not in ('CLS')
    Order by assessment_id
  </select>

  <update id="updateTempOpenByEvent">
        UPDATE assessment_temp SET state='OPN'
        WHERE assessment_event_id = #{eventId}
    </update>
    <update id="reportEvent" parameterType="Integer">
        UPDATE assessment SET state='REP'
        WHERE assessment_event_id = #{eventId} and state='OPN'
    </update>
  <update id="feedbackAssessment" parameterType="Integer">
    UPDATE ASSESSMENT
    SET state = 'FED'
    WHERE assessment_id = #{assessmentId} and state='REP'
  </update>
  <update id="auditAssessmentWithAgree">
    UPDATE ASSESSMENT
    SET state = 'AUD'
    WHERE assessment_id = #{assessmentId} and state='FED'
  </update>
  <update id="auditAssessmentWithDisagree">
    UPDATE ASSESSMENT
    SET state = 'REP'
    WHERE assessment_id = #{assessmentId} and state='FED'
  </update>
  <insert id="insertBySelectEvent">
        INSERT INTO   ASSESSMENT (ASSESSMENT_ID, ASSESSMENT_EVENT_ID,
      AREA_NAME, DISTRICT_NAME, ZONE_NAME,
      ZONE_ATTR, ZONE_CHANNEL_CODE, CHANNEL_NAME,
      ZONE_ID, BILLING_CYCLE, SCORE,
      CRITERION, LAST_REWARD, LAST_FORWARD_REWARD,
      LAST_SETTLEMENT, FORWARD_REWARD, REWARD,
      DOUBLE_REWARD, STATE, CREATE_DATE
      )
      select ASSESSMENT_ID, ASSESSMENT_EVENT_ID,
      AREA_NAME, DISTRICT_NAME, ZONE_NAME,
      ZONE_ATTR, ZONE_CHANNEL_CODE, CHANNEL_NAME,
      ZONE_ID, BILLING_CYCLE, SCORE,
      CRITERION, LAST_REWARD, LAST_FORWARD_REWARD,
      LAST_SETTLEMENT, FORWARD_REWARD, REWARD,
      DOUBLE_REWARD, STATE, CREATE_DATE
      FROM ASSESSMENT_TEMP
      WHERE ASSESSMENT_EVENT_ID = #{eventId}

    </insert>
  <insert id="insertTemp">
    insert into ASSESSMENT_TEMP (ASSESSMENT_ID, ASSESSMENT_EVENT_ID,
      AREA_NAME, DISTRICT_NAME, ZONE_NAME,
      ZONE_ATTR, ZONE_CHANNEL_CODE, CHANNEL_NAME,
      ZONE_ID, BILLING_CYCLE, SCORE,
      CRITERION, LAST_REWARD, LAST_FORWARD_REWARD,
      LAST_SETTLEMENT, FORWARD_REWARD, REWARD,
      DOUBLE_REWARD, STATE, CREATE_DATE
      )
    values (#{assessmentId,jdbcType=DECIMAL}, #{assessmentEventId,jdbcType=DECIMAL},
      #{areaName,jdbcType=VARCHAR}, #{districtName,jdbcType=VARCHAR}, #{zoneName,jdbcType=VARCHAR},
      #{zoneAttr,jdbcType=VARCHAR}, #{zoneChannelCode,jdbcType=DECIMAL}, #{channelName,jdbcType=VARCHAR},
      #{zoneId,jdbcType=DECIMAL}, #{billingCycle,jdbcType=DECIMAL}, #{score,jdbcType=DECIMAL},
      #{criterion,jdbcType=DECIMAL}, #{lastReward,jdbcType=DECIMAL}, #{lastForwardReward,jdbcType=DECIMAL},
      #{lastSettlement,jdbcType=DECIMAL}, #{forwardReward,jdbcType=DECIMAL}, #{reward,jdbcType=DECIMAL},
      #{doubleReward,jdbcType=DECIMAL}, #{state,jdbcType=VARCHAR}, #{createDate,jdbcType=TIMESTAMP}
      )
  </insert>

  <delete id="deleteTempByEvent">

        DELETE FROM ASSESSMENT_TEMP
        where ASSESSMENT_EVENT_ID = #{eventId}
    </delete>
    <delete id="deleteEvent" parameterType="Integer">
      DELETE FROM ASSESSMENT
        where ASSESSMENT_EVENT_ID = #{eventId}
    </delete>
</mapper>